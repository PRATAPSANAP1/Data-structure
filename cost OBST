#include<iostream>
#include<climits>
using namespace std;

class OBST {
public:
int weight(int i,int j,int sp[],int usp[]) {
int wt=0;
for(int k=i;k<=j;k++) 
{
wt+=sp[k];
}
for(int k=i;k<=j+1;k++)
{
 wt+=usp[k];
}
return wt;
}

int cost(int i,int j,int sp[],int usp[]) {
if(i>j)
{
 return 0;
}
if(i==j) {
return sp[i]+usp[i]+usp[i+1];
}
int minCost=INT_MAX;
for(int r=i;r<=j;r++) {
int c=cost(i,r-1,sp,usp)+cost(r+1,j,sp,usp);
int w=weight(i,j,sp,usp);
if(c+w<minCost)
{
 minCost=c+w;
}
}
return minCost;
}
};

int main() {
OBST p;
int n;
cout<<"Enter the number of keys:"; cin>>n;
int key[n],sp[n],usp[n+1];
cout<<"Enter the keys:"; for(int i=0;i<n;i++) cin>>key[i];
cout<<"Enter the successful probabilities:"; for(int i=0;i<n;i++) cin>>sp[i];
cout<<"Enter the unsuccessful probabilities:"; for(int i=0;i<=n;i++) cin>>usp[i];
cout<<"Minimum cost of OBST: "<<p.cost(0,n-1,sp,usp)<<endl;
return 0;
}